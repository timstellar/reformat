<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–∑ –æ—Ç—Ö–æ–¥–æ–≤ - Avant-Garde</title>
    <!-- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å —à—Ä–∏—Ñ—Ç—ã, –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --font-main: 'Montserrat', Arial, sans-serif;
            --font-code: 'Source Code Pro', monospace;
            --color-bg: #f8f9fa;
            --color-text: #212529;
            --color-primary: #0b7a75; /* Deep Teal */
            --color-accent: #f56a79;  /* Coral Pink */
            --color-secondary: #c2a83e; /* Muted Gold */
            --color-border: #dee2e6;
            --color-status-approved: #2a9d8f;
            --color-status-pending: #e9c46a;
            --color-status-rejected: #e76f51;
        }

        body {
            font-family: var(--font-main);
            font-size: 9.5pt; /* –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —á—É—Ç—å –º–µ–Ω—å—à–µ */
            line-height: 1.55;
            margin: 0; /* –£–±–∏—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è body */
            padding: 1.5cm; /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
            color: var(--color-text);
            background-color: var(--color-bg);
            position: relative; /* –î–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
            overflow: hidden; /* –ß—Ç–æ–±—ã –ø—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –≤—ã–ª–µ–∑–∞–ª–∏ –∑–∞ –ø–µ—á–∞—Ç—å */
        }

        /* –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–æ–Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç (–º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω—ã–º –¥–ª—è PDF) */
        body::before {
            content: '';
            position: absolute;
            top: -10%;
            left: -20%;
            width: 70%;
            height: 130%;
            background: linear-gradient(45deg, rgba(11, 122, 117, 0.03), rgba(11, 122, 117, 0));
            transform: rotate(-30deg);
            z-index: 0;
            pointer-events: none; /* –ß—Ç–æ–±—ã –Ω–µ –º–µ—à–∞–ª –∫–æ–Ω—Ç–µ–Ω—Ç—É */
        }

        .content-wrapper { /* –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–≤–µ—Ä—Ö —Ñ–æ–Ω–∞ */
            position: relative;
            z-index: 1;
        }

        /* --- –®–∞–ø–∫–∞ —Å QR –∏ –ó–∞–≥–æ–ª–æ–≤–∫–æ–º --- */
        .header-section {
            display: flex;
            align-items: flex-start;
            margin-bottom: 30px;
            gap: 30px;
        }
        .qr-area {
            flex-shrink: 0;
            width: 140px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid var(--color-border);
            box-shadow: 3px 3px 8px rgba(0,0,0,0.05);
            text-align: center;
            position: relative;
            /* –ù–µ–±–æ–ª—å—à–æ–π –ø–æ–≤–æ—Ä–æ—Ç –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏ (—Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ –¥–ª—è PDF) */
            /* transform: rotate(-2deg); */
             border-left: 5px solid var(--color-secondary); /* –ó–æ–ª–æ—Ç–æ–π –∞–∫—Ü–µ–Ω—Ç */
        }
        .qr-area img { display: block; width: 100%; height: auto; }
        .qr-area span { font-size: 8pt; color: #6c757d; margin-top: 8px; display: block;}

        .title-area { flex-grow: 1; padding-top: 10px; }
        .main-title {
            font-size: 20pt;
            font-weight: 700; /* Bold */
            margin: 0 0 5px 0;
            color: var(--color-primary);
            line-height: 1.2;
        }
        .sub-title { font-size: 11pt; color: #6c757d; margin: 0; }
        .doc-meta { font-size: 10pt; font-weight: 600; color: var(--color-text); margin-top: 10px;}

        /* --- –°—Ç–∞—Ç—É—Å --- */
        .status-banner {
            padding: 10px 20px;
            margin: 0 -20px 30px -20px; /* –í—ã—Ö–æ–¥–∏—Ç –∑–∞ –∫—Ä–∞—è –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏ */
            text-align: center;
            font-weight: 600;
            font-size: 11pt;
            color: #fff;
            position: relative;
            overflow: hidden; /* –î–ª—è –ø—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        }
        /* –¶–≤–µ—Ç–Ω–æ–π —Ñ–æ–Ω –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ */
        .status-approved { background-color: var(--color-status-approved); }
        .status-pending { background-color: var(--color-status-pending); color: var(--color-text); }
        .status-rejected { background-color: var(--color-status-rejected); }
        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–ª–æ—Å—ã –Ω–∞ —Å—Ç–∞—Ç—É—Å–µ (–ø—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç—ã) */
         .status-banner::before, .status-banner::after {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            width: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            transform: skewX(-20deg);
         }
         .status-banner::before { left: 10px; }
         .status-banner::after { right: 10px; }


        /* --- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –ö–∞—Ä—Ç–æ—á–∫–∏ --- */
        .info-card {
            background-color: #fff;
            border: 1px solid var(--color-border);
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 3px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            border-top: 3px solid var(--color-primary); /* –¶–≤–µ—Ç–Ω–æ–π –∞–∫—Ü–µ–Ω—Ç —Å–≤–µ—Ä—Ö—É */
        }
        .card-title {
            font-size: 11pt;
            font-weight: 600;
            color: var(--color-primary);
            margin: -15px -20px 15px -20px;
            padding: 10px 20px;
            border-bottom: 1px solid var(--color-border);
            background-color: rgba(11, 122, 117, 0.05); /* –õ–µ–≥–∫–∏–π —Ñ–æ–Ω –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        }
        .card-grid {
            display: grid;
            grid-template-columns: 150px auto; /* –ú–µ—Ç–∫–∞ | –î–∞–Ω–Ω—ã–µ */
            gap: 8px 15px;
        }
        .grid-label { font-weight: 600; color: #495057; font-size: 9pt; }
        .grid-value { font-size: 9.5pt; }
        /* –ò–∫–æ–Ω–∫–∏ (—Ç—Ä–µ–±—É—é—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–ª–∏ SVG) - –ø—Ä–∏–º–µ—Ä */
        .grid-label::before { /* –ü—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∏–∫–æ–Ω–∫–∏ */
             /* content: 'üë§'; /* –ü—Ä–∏–º–µ—Ä –∏–∫–æ–Ω–∫–∏ - –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FontAwesome –∏–ª–∏ SVG */
             /* display: inline-block; margin-right: 8px; color: var(--color-primary); */
        }

        /* --- –¢–∞–±–ª–∏—Ü–∞ --- */
        .table-section { margin-top: 30px; }
        .table-title {
            font-size: 13pt;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 15px;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: separate; /* –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è border-spacing */
            border-spacing: 0;
            font-size: 9pt;
             border: 1px solid var(--color-border);
             border-radius: 4px;
             overflow: hidden; /* –ß—Ç–æ–±—ã —Å–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–ª–æ */
             box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        th, td {
            padding: 10px 12px;
            text-align: left;
            vertical-align: middle; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
            border-bottom: 1px solid var(--color-border);
        }
        th {
            background: linear-gradient(to bottom, var(--color-primary), darken(var(--color-primary), 5%)); /* –ì—Ä–∞–¥–∏–µ–Ω—Ç –≤ —à–∞–ø–∫–µ */
            color: #fff;
            font-weight: 600;
            font-size: 10pt;
            border-bottom: 2px solid darken(var(--color-primary), 10%);
            text-align: center;
        }
        tbody tr:last-child td { border-bottom: none; } /* –£–±–∏—Ä–∞–µ–º –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É —É –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ */
        tbody tr:nth-child(even) { background-color: rgba(11, 122, 117, 0.03); } /* –õ–µ–≥–∫–∞—è –∑–µ–±—Ä–∞ */
        tbody tr:hover { background-color: rgba(245, 106, 121, 0.1); } /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ (–Ω–µ –¥–ª—è PDF) */

        .code-cell { font-family: var(--font-code); text-align: center; }
        .class-cell { text-align: center; font-weight: 600; }
        .qty-cell { text-align: right; font-weight: 600; }

        .total-row td {
            font-weight: 700;
            background-color: #e9ecef;
            color: var(--color-text);
            font-size: 10pt;
            border-top: 2px solid #adb5bd;
        }
        .total-label { text-align: right; }

         /* --- –î–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è --- */
        .notes-area {
            margin-top: 25px;
            padding: 15px;
            font-size: 9pt;
            background-color: #fff;
            border-left: 4px solid var(--color-secondary); /* –ó–æ–ª–æ—Ç–∞—è –ª–∏–Ω–∏—è —Å–ª–µ–≤–∞ */
            border-top: 1px solid var(--color-border);
             border-right: 1px solid var(--color-border);
             border-bottom: 1px solid var(--color-border);
             border-radius: 0 3px 3px 0;
        }
        .notes-area p { margin: 0 0 8px 0; }
        .notes-area strong { color: var(--color-primary); font-weight: 600;}

        /* --- –ü–æ–¥–ø–∏—Å–∏ --- */
        .signatures-zone {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px dashed var(--color-border); /* –ü—É–Ω–∫—Ç–∏—Ä–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å */
            display: flex;
            justify-content: space-around; /* –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ */
            gap: 30px;
            text-align: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –±–ª–æ–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π */
        }
        .signature-unit { width: 45%; font-size: 9pt; }
        .signature-role { font-weight: 600; margin-bottom: 10px; color: var(--color-primary); }
        .signature-space {
            height: 40px;
            border-bottom: 1px solid #adb5bd;
            margin: 20px 0 10px 0;
        }
        .signature-details { color: #6c757d; line-height: 1.4; }
        .signature-details p { margin: 2px 0; }

        @media print {
            body { margin: 0; padding: 1cm; font-size: 9pt; color: #000; background-color: #fff; }
            body::before { display: none; } /* –£–±–∏—Ä–∞–µ–º —Å–ª–æ–∂–Ω—ã–π —Ñ–æ–Ω */
            .content-wrapper { }
            .qr-area { box-shadow: none; border: 1px solid #aaa; transform: none; }
            .status-banner { margin: 0 0 20px 0; color: #000 !important; } /* –£–ø—Ä–æ—â–∞–µ–º —Å—Ç–∞—Ç—É—Å –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            .status-banner::before, .status-banner::after { display: none; }
            .status-approved { background-color: #c3e6cb !important; border: 1px solid #aaa;}
            .status-pending { background-color: #ffeeba !important; border: 1px solid #aaa;}
            .status-rejected { background-color: #f5c6cb !important; border: 1px solid #aaa;}
            .info-card { box-shadow: none; border: 1px solid #bbb; border-top: 2px solid #888; }
            .card-title { background-color: #eee; color: #000; }
            table { box-shadow: none; border: 1px solid #888; }
            th, td { border-bottom: 1px solid #aaa; }
            th { background: #ddd !important; color: #000; border-bottom: 1px solid #888;}
            tbody tr:nth-child(even) { background-color: #f3f3f3; }
            .notes-area { border: 1px dashed #aaa; border-left: 3px solid #888;}
            .signatures-zone { border-top: 1px dashed #888; }
        }
    </style>
</head>
<body>
<div class="content-wrapper">

    <!-- –®–∞–ø–∫–∞ -->
    <div class="header-section">
        <div class="qr-area">
            {% if qr_url_code_data_uri %}
                <img src="{{ qr_url_code_data_uri }}" alt="QR –∫–æ–¥">
                <span>–°—Å—ã–ª–∫–∞ –Ω–∞ —Å–∞–π—Ç</span>
            {% endif %}
        </div>
        <div class="title-area">
            <h1 class="main-title">–ó–ê–Ø–í–ö–ê</h1>
            <h2 class="sub-title">–Ω–∞ –≤—ã–≤–æ–∑ –æ—Ç—Ö–æ–¥–æ–≤ I –∏ II –∫–ª–∞—Å—Å–æ–≤ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h2>
            <div class="doc-meta">
                ‚Ññ {{ request_number }} / –î–∞—Ç–∞: {{ request_date }}
            </div>
        </div>
    </div>

    <!-- –°—Ç–∞—Ç—É—Å -->
    {% if status %}
    <div class="status-banner {% if status == '–û–¥–æ–±—Ä–µ–Ω–∞' %}status-approved{% elif status == '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏' %}status-pending{% elif status == '–û—Ç–∫–ª–æ–Ω–µ–Ω–∞' %}status-rejected{% endif %}">
        –°—Ç–∞—Ç—É—Å –ó–∞—è–≤–∫–∏: {{ status }} {% if status == '–û–¥–æ–±—Ä–µ–Ω–∞' %} (–ü—Ä–∏–Ω—è—Ç–∞ {{ approval_date }}){% endif %}
    </div>
    {% endif %}

    <!-- –ò–Ω—Ñ–æ-–∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <div class="info-card">
        <div class="card-title">–ó–∞—è–≤–∏—Ç–µ–ª—å</div>
        <div class="card-grid">
            <div class="grid-label">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ:</div> <div class="grid-value">{{ requester.name }}</div>
            <div class="grid-label">–ò–ù–ù:</div> <div class="grid-value">{{ requester.inn }}</div>
            <div class="grid-label">–ê–¥—Ä–µ—Å:</div> <div class="grid-value">{{ requester.address }}</div>
            <div class="grid-label">–ö–æ–Ω—Ç–∞–∫—Ç:</div> <div class="grid-value">{{ requester.contact_person }}</div>
            <div class="grid-label">–¢–µ–ª–µ—Ñ–æ–Ω:</div> <div class="grid-value">{{ requester.phone }}</div>
        </div>
    </div>

    <div class="info-card">
         <div class="card-title">–î–µ—Ç–∞–ª–∏ –í—ã–≤–æ–∑–∞</div>
         <div class="card-grid">
            <div class="grid-label">–î–æ–≥–æ–≤–æ—Ä:</div> <div class="grid-value">‚Ññ {{ contract.number }} –æ—Ç {{ contract.date }}</div>
            <div class="grid-label">–ê–¥—Ä–µ—Å –≤—ã–≤–æ–∑–∞:</div> <div class="grid-value">{{ pickup_address }}</div>
            <div class="grid-label">–ñ–µ–ª–∞–µ–º–∞—è –¥–∞—Ç–∞:</div> <div class="grid-value">{{ preferred_date }}</div>
            <div class="grid-label">–ñ–µ–ª–∞–µ–º–æ–µ –≤—Ä–µ–º—è:</div> <div class="grid-value">{{ preferred_time }}</div>
         </div>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ -->
    <div class="table-section">
        <h3 class="table-title">–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –û—Ç—Ö–æ–¥–æ–≤</h3>
        <table>
            <thead>
                <tr>
                    <th>‚Ññ</th>
                    <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –û—Ç—Ö–æ–¥–∞</th>
                    <th class="code-cell">–ö–æ–¥ –§–ö–ö–û</th>
                    <th class="class-cell">–ö–ª–∞—Å—Å</th>
                    <th class="qty-cell">–ö–æ–ª-–≤–æ (–∫–≥)</th>
                    <th>–£–ø–∞–∫–æ–≤–∫–∞</th>
                </tr>
            </thead>
            <tbody>
                {% for waste in wastes %}
                <tr>
                    <td style="text-align: center;">{{ loop.index }}</td>
                    <td>{{ waste.name }}</td>
                    <td class="code-cell">{{ waste.code }}</td>
                    <td class="class-cell">{{ waste.hazard_class }}</td>
                    <td class="qty-cell">{{ waste.quantity }}</td>
                    <td>{{ waste.packaging }}</td>
                </tr>
                {% endfor %}
                <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
                <tr class="total-row">
                    <td colspan="4" class="total-label">–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:</td>
                    <td class="qty-cell">{{ total_quantity }}</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- –î–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    {% if special_requirements or additional_info %}
    <div class="notes-area">
        {% if special_requirements %}
            <p><strong>–û—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:</strong> {{ special_requirements }}</p>
        {% endif %}
         {% if additional_info %}
             <p><strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> {{ additional_info }}</p>
         {% endif %}
    </div>
    {% endif %}

    <!-- –ü–æ–¥–ø–∏—Å–∏ -->
    <div class="signatures-zone">
        <div class="signature-unit">
            <div class="signature-role">–ó–ê–Ø–í–ò–¢–ï–õ–¨</div>
            <div class="signature-space"></div>
            <div class="signature-details">
                <p>{{ requester.representative.position }}</p>
                <p>{{ requester.representative.name }}</p>
                <p>(–ü–æ–¥–ø–∏—Å—å)</p>
                <p>–ú.–ü.</p>
            </div>
        </div>
         {% if status == '–û–¥–æ–±—Ä–µ–Ω–∞' %}
        <div class="signature-unit">
             <div class="signature-role">–ó–ê–Ø–í–ö–£ –ü–†–ò–ù–Ø–õ (–û–ü–ï–†–ê–¢–û–†)</div>
            <div class="signature-space"></div>
             <div class="signature-details">
                <p>{{ operator.position }}</p>
                <p>{{ operator.name }}</p>
                <p>(–ü–æ–¥–ø–∏—Å—å)</p>
                <p>–î–∞—Ç–∞: {{ approval_date }}</p>
                <p>–ú.–ü.</p>
            </div>
        </div>
        {% endif %}
    </div>

</div> <!-- /content-wrapper -->
</body>
</html>